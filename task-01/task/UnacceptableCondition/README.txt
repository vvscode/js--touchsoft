Пример работающего кода:

https://output.jsbin.com/rimosof/8

Работающие тесты:

https://output.jsbin.com/rimosof