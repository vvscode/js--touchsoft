Пример работающего кода:

http://jsbin.com/pijere/1/edit?html,js,output

Работающие тесты:

http://jsbin.com/quyegix/edit?html,js,output
